<!DOCTYPE html>
<html>
<head>
  <title>Phone Login and Form</title>
</head>
<body>
  <div id="recaptcha-container"></div>
  <button id="phone-login-button">Phone Login</button>

  <!-- Add the form for username and category data -->
  <form id="username-category-form" style="display: none;">
    <label for="new-username">Username:</label>
    <input type="text" id="new-username" required>

    <label for="kategori">Category:</label>
    <select id="kategori" required>
      <option value="category1">Category 1</option>
      <option value="category2">Category 2</option>
      <!-- Add more options as needed -->
    </select>

    <button type="button" id="submit-button">Submit</button>
  </form>

  <!-- Elements for login, signup, and error messages -->
  <form id="login-form">
    <label for="email">Email:</label>
    <input type="email" id="email" required>
    <label for="password">Password:</label>
    <input type="password" id="password" required>
    <button type="button" onclick="login()">Login</button>
  </form>

  <form id="signup-form" style="display: none;">
    <label for="new-email">Email:</label>
    <input type="email" id="new-email" required>
    <label for="new-password">Password:</label>
    <input type="password" id="new-password" required>
    <button type="button" onclick="signup()">Signup</button>
  </form>

  <div id="success-message" style="display: none;">Login successful!</div>
  <div id="error-message" style="display: none; color: red;"></div>

  <script src="https://www.gstatic.com/firebasejs/9.6.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.2/firebase-firestore.js"></script>
  <script>
    // Firebase configuration
var firebaseConfig = {
  apiKey: "AIzaSyA_2_DrjTzs1cIOY9_5mloWYcdLxpsFq5c",
  authDomain: "koraa-id.firebaseapp.com",
  databaseURL: "https://koraa-id-default-rtdb.firebaseio.com",
  projectId: "koraa-id",
  storageBucket: "koraa-id.appspot.com",
  messagingSenderId: "360256061577",
  appId: "1:360256061577:web:5d9dbb92ff3313c7b48658",
  measurementId: "G-VJT00SD3NT"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
var db = firebase.firestore();

// Get elements
var loginForm = document.getElementById('login-form');
var signupForm = document.getElementById('signup-form');
var successMessage = document.getElementById('success-message');
var errorMessage = document.getElementById('error-message');
var usernameCategoryForm = document.getElementById('username-category-form');

// Google login
// (Existing code for Google login)

// Google signup
// (Existing code for Google signup)

// Phone login
function phoneLogin() {
  var phoneNumber = prompt("Please enter your phone number with country code (e.g., +1234567890):");
  if (phoneNumber) {
    var appVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container');
    firebase.auth().signInWithPhoneNumber(phoneNumber, appVerifier)
      .then(function (confirmationResult) {
        var verificationCode = prompt("Please enter the verification code sent to your phone:");
        return confirmationResult.confirm(verificationCode);
      })
      .then(function (result) {
        // Phone login successful, handle the user data here
        // For simplicity, we can redirect the user to the form to input username and category data
        usernameCategoryForm.style.display = 'block';
      })
      .catch(function (error) {
        errorMessage.innerHTML = error.message;
        errorMessage.style.display = 'block';
      });
  }
}

// Event listener for the phone login button
document.getElementById('phone-login-button').addEventListener('click', phoneLogin);

// Show login form
// (Existing code for showLoginForm)

// Perform login
// (Existing code for login)

// Perform signup
// (Existing code for signup)

// Load category page dynamically using AJAX
// (Existing code for loadCategoryPage)

// Validate form and enable/disable sign up button
// (Existing code for validateForm)

// Event listener for form submission
document.getElementById('submit-button').addEventListener('click', function () {
  signup(); // Call the existing signup function to store the data in Firestore
});

// Check if user is already logged in
// (Existing code for onAuthStateChanged)

  </script>
</body>
</html>
