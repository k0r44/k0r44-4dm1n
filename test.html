<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Items</title>
</head>
<body>
  <div class="inbox-test"></div>

  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.10/firebase-firestore.js"></script>

  <script>
    // Inisialisasi Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyA_2_DrjTzs1cIOY9_5mloWYcdLxpsFq5c",
  authDomain: "koraa-id.firebaseapp.com",
  projectId: "koraa-id",
  storageBucket: "koraa-id.appspot.com",
  messagingSenderId: "360256061577",
  appId: "1:360256061577:web:5d9dbb92ff3313c7b48658",
  measurementId: "G-VJT00SD3NT"
    };
    firebase.initializeApp(firebaseConfig);

    // Referensi ke koleksi "users" dengan user UID
    var userCollection = firebase.firestore().collection("users").doc(user.uid).collection("mails");

    // Fungsi untuk mendapatkan item-item pengguna dan menambahkan listener realtime
    function getUserItems(author) {
      userCollection.onSnapshot((querySnapshot) => {
        const itemsContainer = document.querySelector(".inbox-test");
        let html = "";

        querySnapshot.forEach((doc) => {
          const item = doc.data();
          const itemId = doc.id;

          const itemHtml = `
            <div class="d-flex">
              <div class="flex-shrink-0">
                <img class="me-3 rounded-circle" src="../assets/images/user/user.png" alt="">
              </div>
              <div class="flex-grow-1">
                <h6>${item.username}</h6>
                <p>${item.description}</p>
              </div>
            </div>
          `;

          html += itemHtml;
        });

        // Render tampilan HTML setelah semua item ditambahkan
        itemsContainer.innerHTML = html;
      });
    }

    // Panggil fungsi getUserItems dengan parameter user UID
    getUserItems(user.uid);
  </script>
</body>
</html>
