<!DOCTYPE html>
<html>
<head>
  <title>Mail Details</title>
  <style>
    /* Tambahkan gaya CSS sesuai kebutuhan Anda */
    .mail-details {
      padding: 20px;
    }
  </style>
</head>
<body>
  <div class="mail-details">
    <h1>Mail Details</h1>
    <div class="mail-content"></div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-auth.js"></script>
  <script>
    // Inisialisasi Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyA_2_DrjTzs1cIOY9_5mloWYcdLxpsFq5c",
  authDomain: "koraa-id.firebaseapp.com",
  projectId: "koraa-id",
  storageBucket: "koraa-id.appspot.com",
  messagingSenderId: "360256061577",
  appId: "1:360256061577:web:5d9dbb92ff3313c7b48658",
  measurementId: "G-VJT00SD3NT"
    };

    firebase.initializeApp(firebaseConfig);

    // Mengambil referensi Firestore
    const db = firebase.firestore();

    // Mendapatkan ID item dari URL
    const urlParams = new URLSearchParams(window.location.search);
    const itemId = urlParams.get('id');

    // Mendapatkan ID pengguna saat ini
    firebase.auth().onAuthStateChanged(function(user) {
      if (user) {
        const userId = user.uid;

        // Mendapatkan referensi koleksi Firestore
        const collectionRef = db.collection(`users/${userId}/mails`);

        // Mendapatkan detail item dari Firestore berdasarkan ID
        collectionRef.doc(itemId).get()
          .then(function(doc) {
            if (doc.exists) {
              const mail = doc.data();

              // Menampilkan konten surat pada halaman
              const mailContentElements = document.getElementsByClassName('mail-content');
              for (let i = 0; i < mailContentElements.length; i++) {
                const mailContentElement = mailContentElements[i];
                mailContentElement.innerHTML = `
                  <h2>${mail.username}</h2>
                  <p>From: ${mail.from}</p>
                  <p>To: ${mail.to}</p>
                  <p>Date: ${mail.date}</p>
                  <p>${mail.body}</p>
                `;
              }
            } else {
              console.log('Document not found');
            }
          })
          .catch(function(error) {
            console.log(error);
          });
      } else {
        console.log('User not logged in');
      }
    });
  </script>
</body>
</html>
