 // Mengambil referensi Firestore
 const db = firebase.firestore();

 // Get user details elements
 var userfullNameText = document.getElementsByClassName('user-fullname')[0];
 var userEmailText = document.getElementsByClassName('user-email')[0];
 var userCategoryText = document.getElementsByClassName('user-category')[0];
 var userPictureSRC = document.getElementsByClassName('user-pic')[0];
 var usernameText = document.getElementsByClassName('username')[0];
 var signupTimeText = document.getElementsByClassName('signup-time')[0];
 var planExpirationText = document.getElementsByClassName('plan-expiration')[0];
 var userLinksText = document.getElementsByClassName('user-links')[0];
 var birthdayText = document.getElementsByClassName('birthday')[0];
 var userBioText = document.getElementsByClassName('user-bio')[0];

 // Set user details and login time
 firebase.auth().onAuthStateChanged(function (user) {
   if (user) {
     var author = user.uid;
     var categoryRef = firebase.firestore().collection('users').doc(author);
     categoryRef.get()
       .then(function (doc) {
         if (doc.exists) {

           // Get user details from Firestore data
           var firstName = doc.data().firstName;
           var lastName = doc.data().lastName;

           if (firstName || lastName) {
             userfullNameText.textContent = (firstName ? firstName + " " : "") + (lastName ? lastName : "");
           } else {
             userfullNameText.textContent = "By Koraa";
           }

           userEmailText.textContent = user.email;
           userCategoryText.textContent = doc.data().category;

           // Check if the data profile is available
           if (doc.data().profile) {
             userPictureSRC.src = doc.data().profile;
           } else {
             userPictureSRC.src = 'https://www.koraa.my.id/assets/img/logo/koraa.png'; // Use a default image if profile data is not available
           }

           // Check if the user is verified and add the icon accordingly
           if (doc.data().verify === true) {
             usernameText.textContent = doc.data().username + ' '; // Add a space after the username to separate it from the icon
             var iconElement = document.createElement('i');
             iconElement.classList.add('ri-checkbox-circle-line');
             usernameText.appendChild(iconElement);
           } else {
             usernameText.textContent = doc.data().username;
           }

           signupTimeText.textContent = doc.data().signupTime;

           // Check if the birthday data is available
           if (doc.data().birthday) {
             birthdayText.textContent = doc.data().birthday; // Show the current time
           } else {
             birthdayText.textContent = "No Data Available";
           }

           // Check if the planExpiration data is available
           if (doc.data().planExpiration) {
             planExpirationText.textContent = doc.data().planExpiration; // Show the current time
           } else {
             planExpirationText.textContent = "Plan not available";
           }

           // Create a link element
           var userLinksLink = document.createElement('a');
           userLinksLink.href = "https://www.koraa.my.id/user/?author=" + doc.data().username;
           userLinksLink.textContent = "https://www.koraa.my.id/user/?author=" + doc.data().username;
           userLinksLink.target = "_blank";

           // Clear previous content and append the link element
           userLinksText.innerHTML = '';
           userLinksText.appendChild(userLinksLink);

           // Check if the bio data is available
           if (doc.data().bio) {
             userBioText.innerHTML = doc.data().bio;
           } else {
             userBioText.textContent = "Bio not available";
           }

           // Assuming you have a field named 'totalView' in your document
           var totalViews = doc.data().count.view.totalView || 0; // Default to 0 if the data doesn't exist

           // Call the function to create the chart
           createChart(totalViews);

         } else {
           userfullNameText.textContent = "User not logged in";
           userEmailText.textContent = "Email not available";
           userCategoryText.textContent = "Category not available";
           signupTimeText.textContent = "";
           planExpirationText.textContent = "User not logged in";
           userBioText.textContent = "User not logged in";
           birthdayText.textContent = "User not logged in";

           // Add click event listener to redirect to login page
           loginTimeText.addEventListener('click', function () {
             window.location.href = '/auth/login/'; // Change '/login' to the correct URL for the login page
           });
         }
       })
       .catch(function (error) {
         console.log(error);
       });
   } else {
     userEmailText.textContent = "User not logged in";
     userCategoryText.textContent = "";
     planExpirationText.textContent = "User not logged in";
     signupTimeText.textContent = "User not logged in";
     loginTimeText.textContent = "User not logged in";
     birthdayText.textContent = "User not logged in";

     // Add click event listener to redirect to login page
     userEmailText.addEventListener('click', function () {
       window.location.href = '/auth/login/'; // Change '/login' to the correct URL for the login page
     });

     signupTimeText.addEventListener('click', function () {
       window.location.href = '/auth/login/'; // Change '/login' to the correct URL for the login page
     });

     loginTimeText.addEventListener('click', function () {
       window.location.href = '/auth/login/'; // Change '/login' to the correct URL for the login page
     });
   }
 });

 // Get logout button element
 var logoutButton = document.getElementById('logout-button');

 // Add event listener to logout button
 logoutButton.addEventListener('click', function () {
   firebase.auth().signOut()
     .then(function () {
       // Redirect to the login page after successful logout
       window.location.href = '/auth/login/'; // Change '/login' to the correct URL for the login page
     })
     .catch(function (error) {
       console.log(error);
     });
 });