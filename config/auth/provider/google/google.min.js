firebase.initializeApp(firebaseConfig);

    // Function to save the username
    function saveUsername() {
      var username = document.getElementById('username').value;
      var user = firebase.auth().currentUser;

      if (user) {
        // Check if the username is already taken
        var db = firebase.firestore();
        var usersCollectionRef = db.collection('users');

        usersCollectionRef
          .where('username', '==', username) // Check if the username already exists
          .get()
          .then(function(querySnapshot) {
            if (!querySnapshot.empty) {
              displayErrorMessage(); // Show error message when username is taken
            } else {
              // Update the user's username in the Firestore document
              var userRef = db.collection('users').doc(user.uid);
              userRef
                .update({ username: username })
                .then(function() {
                  // Redirect the user to the root page after saving the username
                  window.location.href = '/';
                })
                .catch(function(error) {
                  console.error('Error updating username:', error);
                });
            }
          })
          .catch(function(error) {
            console.error('Error checking username availability:', error);
          });
      }
    }

    // Function to display the error message
    function displayErrorMessage() {
      var errorMessage = document.getElementById('error-message');
      errorMessage.style.display = 'block';
    }

    function displaySuccessMessage() {
        var successMessage = document.getElementById('success-message');
        successMessage.style.display = 'block';
    }