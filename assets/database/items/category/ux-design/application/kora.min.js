// Access Firestore collection
const db = firebase.firestore().collection("/koraa/items/category/ux design/application/");

// Get the form element
var myForm = document.getElementById('myForm');

// Listen for form submission
myForm.addEventListener('submit', function(e) {
  e.preventDefault();

  // Get form values
  var img = document.getElementById('img').value;
  var name = document.getElementById('name').value;
  var author = document.getElementById('author').value;
  var preview = document.getElementById('preview').value;


  // Save data to Firestore
  db.add({
    img: img,
    name: name,
    author: author,
    preview: preview,
    
  })
  .then(function(docRef) {
    alert('Form submitted successfully');
    myForm.reset();
    console.log('Document written with ID: ', docRef.id);
  })
  .catch(function(error) {
    console.error('Error adding document: ', error);
  });
});

// Upload image to Firebase Storage
var storageRef = firebase.storage().ref();

document.getElementById('fileButton').addEventListener('change', function(e) {
  var file = e.target.files[0];
  var fileName = Date.now() + '_' + file.name;
  var uploadTask = storageRef.child('items/category/ux design/application/' + fileName).put(file);

  uploadTask.on('state_changed', function(snapshot) {
    var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
    console.log('Upload is ' + progress + '% done');
  }, function(error) {
    console.error('Error uploading file: ', error);
  }, function() {
    uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
      console.log('File available at', downloadURL);
      document.getElementById('img').value = downloadURL;
    });
  });
});